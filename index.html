<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADMINISTRACIÃ“N - Grupo Colbert</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Roboto', sans-serif; 
            background: #222; 
            color: white; 
            padding: 40px; 
        }
        .container { 
            max-width: 600px; 
            margin: 0 auto; 
            background: #333; 
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.5); 
        }
        h1 { 
            text-align: center; 
            color: #0099ff; 
            border-bottom: 2px solid #555; 
            padding-bottom: 10px; 
            margin-top: 0;
        }
        h2 {
            text-align: center;
            font-size: 14px;
            color: #aaa;
            font-weight: normal;
            margin-bottom: 20px;
        }
        label { 
            display: block; 
            margin-top: 15px; 
            font-size: 13px; 
            color: #ccc; 
            font-weight: bold;
        }
        input, select { 
            width: 100%; 
            padding: 12px; 
            margin-top: 5px; 
            background: #444; 
            border: 1px solid #666; 
            color: white; 
            border-radius: 5px; 
            box-sizing: border-box;
            font-size: 14px;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #0099ff;
            background: #555;
        }
        button.generate-btn { 
            width: 100%; 
            padding: 15px; 
            margin-top: 25px; 
            background: #00c853; 
            color: white; 
            border: none; 
            font-weight: bold; 
            font-size: 16px; 
            cursor: pointer; 
            border-radius: 5px; 
            transition: background 0.3s;
        }
        button.generate-btn:hover { 
            background: #00e676; 
        }
        
        .result-box { 
            margin-top: 25px; 
            padding: 15px; 
            background: #1a1a1a; 
            border: 1px dashed #0099ff; 
            border-radius: 5px;
            display: none; 
            word-break: break-all; 
        }
        .link-display {
            font-family: monospace;
            color: #ddd;
            font-size: 12px;
            margin: 10px 0;
            display: block;
            background: #000;
            padding: 5px;
            border-radius: 3px;
        }
        .copy-btn { 
            background: #0099ff; 
            color: white;
            border: none;
            width: 100%;
            padding: 8px; 
            font-size: 13px; 
            font-weight: bold;
            cursor: pointer;
            border-radius: 4px;
        }
        .copy-btn:hover { background: #0077cc; }
    </style>
</head>
<body>
    <div class="container">
        <h1>PANEL ADMIN</h1>
        <h2>Generador de Accesos Seguros para Alumnos</h2>

        <label>1. Seleccionar Registro / Color:</label>
        <select id="registro">
            <option value="tema-remaep">R.E.M.A.E.P (Azul - Salud)</option>
            <option value="tema-rniue">R.N.I.U.E (Dorado - Instructor)</option>
            <option value="tema-rubra">R.U.B.R.A (Rojo - Rescate)</option>
            <option value="tema-rmts">R.M.T.S (Verde - TÃ¡ctico)</option>
            <option value="tema-rce">R.C.E (Amarillo - Chofer)</option>
            <option value="tema-rpde">R.P.D.E (Celeste - Deporte)</option>
        </select>

        <label>2. TÃ­tulo de CertificaciÃ³n (Tal cual saldrÃ¡ en el carnet):</label>
        <input type="text" id="titulo" placeholder="Ej: PARAMÃ‰DICO PROFESIONAL">

        <label>3. Apellido y Nombres del Alumno:</label>
        <input type="text" id="nombre" placeholder="Ej: PÃ‰REZ JUAN ANDRÃ‰S">

        <label>4. DNI / CÃ©dula:</label>
        <input type="text" id="dni">

        <label>5. MatrÃ­cula / Legajo:</label>
        <input type="text" id="matricula">

        <label>6. AÃ±o Lectivo:</label>
        <input type="number" id="anio" value="2026">

        <label>7. Fecha de Vencimiento:</label>
        <input type="date" id="vence">

        <button class="generate-btn" onclick="generarLink()">ðŸ”’ GENERAR LINK UNICO</button>

        <div class="result-box" id="resultado">
            <p style="color:#0099ff; font-weight:bold; margin-top:0;">Â¡Link Generado con Ã‰xito!</p>
            <p style="font-size:12px; color:#aaa; margin-bottom:5px;">Copia y envÃ­a este enlace al alumno:</p>
            <span id="link-url" class="link-display"></span>
            <button class="copy-btn" onclick="copiarLink()">Copiar Link</button>
        </div>
    </div>

    <script>
        // Establecer fecha de vencimiento por defecto (1 aÃ±o)
        document.addEventListener('DOMContentLoaded', () => {
            const date = new Date();
            date.setFullYear(date.getFullYear() + 1);
            document.getElementById('vence').valueAsDate = date;
        });

        function generarLink() {
            // 1. Capturar datos del formulario
            const datos = {
                reg: document.getElementById('registro').value,
                tit: document.getElementById('titulo').value.toUpperCase(),
                nom: document.getElementById('nombre').value.toUpperCase(),
                dni: document.getElementById('dni').value,
                mat: document.getElementById('matricula').value,
                anio: document.getElementById('anio').value,
                ven: document.getElementById('vence').value
            };

            // 2. ValidaciÃ³n bÃ¡sica
            if(!datos.nom || !datos.dni || !datos.tit) { 
                alert("Por favor, complete al menos: TÃ­tulo, Nombre y DNI."); 
                return; 
            }

            // 3. EncriptaciÃ³n (Token Base64)
            // Convierte el objeto JSON a string y luego lo codifica para que no sea legible a simple vista en la URL
            const token = btoa(JSON.stringify(datos));

            // 4. ConstrucciÃ³n Inteligente de la URL (Compatible con GitHub Pages)
            // Obtiene la direcciÃ³n actual hasta la Ãºltima barra '/' eliminando 'index.html' si existe.
            let path = window.location.href.substring(0, window.location.href.lastIndexOf('/'));
            
            // Construye la URL final apuntando al archivo del alumno
            const urlFinal = `${path}/vista_alumno.html?token=${token}`;

            // 5. Mostrar resultado
            document.getElementById('link-url').innerText = urlFinal;
            document.getElementById('resultado').style.display = 'block';
        }

        function copiarLink() {
            const texto = document.getElementById('link-url').innerText;
            navigator.clipboard.writeText(texto).then(() => {
                alert("âœ… Link copiado al portapapeles");
            }).catch(err => {
                alert("Error al copiar. Por favor selecciona el texto y cÃ³pialo manualmente.");
            });
        }
    </script>
</body>
</html>
