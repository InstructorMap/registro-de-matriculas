<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Credencial Virtual V6 - Borde Integrado</title>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <style>
        /* --- RESET Y ESTRUCTURA BASE --- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: #1a1a1a; /* Fondo oscuro para resaltar la credencial */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 30px;
            flex-direction: column;
            gap: 30px;
        }

        /* --- CONTENEDOR PRINCIPAL DE LA TARJETA --- */
        .card {
            /* Dimensiones fijas para asegurar el aspecto de carnet */
            width: 800px;
            height: 500px;
            background: #fff;
            border-radius: 30px; /* Bordes redondeados modernos */
            box-shadow: 0 15px 35px rgba(0,0,0,0.5); /* Sombra profunda */
            display: flex;
            overflow: hidden; /* Asegura que nada se salga de los bordes redondos */
            position: relative;

            /* --- NUEVO EN V6: BORDE AZUL GENERAL --- */
            /* Esto integra el dise√±o y enmarca el tri√°ngulo */
            border: 4px solid #0033cc;
        }

        /* --- SECCI√ìN IZQUIERDA (FOTO) --- */
        .left-section {
            width: 35%; /* Ocupa un poco m√°s de un tercio */
            position: relative;
            background-color: #ddd; /* Color de fondo mientras carga la foto */
        }

        .student-photo {
            width: 100%;
            height: 100%;
            object-fit: cover; /* La foto cubre todo el espacio sin deformarse */
            display: block;
        }

        /* --- EL TRI√ÅNGULO DE ESQUINA (V6 Ajustado) --- */
        .triangle-overlay {
            position: absolute;
            bottom: -250px; /* Lo empujamos hacia abajo */
            left: -250px;   /* Lo empujamos hacia la izquierda */
            width: 500px;   /* Un cuadrado grande */
            height: 500px;
            /* Rotamos el cuadrado 45 grados para formar el tri√°ngulo */
            transform: rotate(45deg);
            
            /* El fondo azul met√°lico se aplica aqu√≠ v√≠a JS */
            background: #0033cc; 
            z-index: 2; /* Se superpone a la foto */
            
            /* --- AJUSTE V6: Borde blanco m√°s fino --- */
            /* Reducido de 15px a 8px para que sea m√°s sutil */
            border-top: 8px solid white;
            border-right: 8px solid white;
            /* Sombra suave para dar relieve sobre la foto */
            box-shadow: 5px -5px 15px rgba(0,0,0,0.3);
        }

        /* Texto de la sigla dentro del tri√°ngulo */
        .reg-text {
            position: absolute;
            /* Posicionamiento fino para que quede centrado en la franja azul */
            bottom: 230px;
            left: 260px;
            /* Contrarrestamos la rotaci√≥n del padre para que el texto se lea bien */
            transform: rotate(-45deg);
            color: white;
            font-weight: 900; /* Fuente muy gruesa */
            font-size: 24px;
            letter-spacing: 2px; /* Separaci√≥n entre letras */
            text-shadow: 1px 1px 3px rgba(0,0,0,0.4);
        }

        /* C√≥digo QR superpuesto en la esquina de la foto */
        .qr-overlay {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 90px;
            height: 90px;
            background: rgba(255, 255, 255, 0.9); /* Fondo blanco semitransparente */
            padding: 5px;
            border-radius: 10px;
            z-index: 3; /* Por encima del tri√°ngulo */
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        .qr-overlay img {
            width: 100%;
            height: 100%;
        }

        /* --- SECCI√ìN DERECHA (DATOS) --- */
        .right-section {
            width: 65%;
            /* El fondo base se define v√≠a JS (gradiente met√°lico) */
            background: #0033cc; 
            padding: 25px;
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: space-between; /* Distribuye el espacio verticalmente */
            position: relative;
        }

        /* Capa de ruido para textura met√°lica */
        .texture-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            /* Un patr√≥n SVG sutil para dar textura */
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 250 250' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='4' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.15'/%3E%3C/svg%3E");
            mix-blend-mode: overlay; /* Se mezcla con el fondo azul */
            opacity: 0.4;
            pointer-events: none; /* No interfiere con clicks */
        }

        /* Contenedor del contenido para asegurar que est√© sobre la textura */
        .content-container {
            position: relative;
            z-index: 2;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        /* --- HEADER (Carnet y A√±o) --- */
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            border-bottom: 4px solid rgba(255, 255, 255, 0.8); /* L√≠nea divisoria */
            padding-bottom: 5px;
            margin-bottom: 15px;
        }
        .main-header {
            font-size: 42px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        .year-header {
            font-size: 48px;
            font-weight: 900;
            color: #fff;
            /* Un peque√±o efecto de resplandor en el a√±o */
            text-shadow: 0 0 10px rgba(255,255,255,0.6), 2px 2px 4px rgba(0,0,0,0.5);
        }

        /* --- T√çTULO CENTRAL (Param√©dico...) --- */
        .title-container {
            text-align: center;
            flex-grow: 1; /* Ocupa el espacio central disponible */
            display: flex;
            flex-direction: column;
            justify-content: center;
            text-transform: uppercase;
            font-weight: 900;
            /* Fondo semitransparente para resaltar el t√≠tulo */
            background: rgba(0,0,0,0.2);
            border-radius: 15px;
            margin: 10px 0;
            padding: 15px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            box-shadow: inset 0 0 20px rgba(0,0,0,0.3); /* Sombra interna */
        }
        .main-title {
            font-size: 42px; /* Tama√±o base, se ajusta con JS */
            line-height: 1.1;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.6);
        }
        .sub-title {
            font-size: 28px; /* Tama√±o base, se ajusta con JS */
            margin-top: 5px;
            color: #e0e0e0; /* Un blanco ligeramente apagado */
            text-shadow: 2px 2px 4px rgba(0,0,0,0.6);
        }

        /* --- NOMBRE DEL ALUMNO --- */
        .student-name-container {
            text-align: center;
            margin: 15px 0;
            background: rgba(255, 255, 255, 0.15); /* Fondo claro sutil */
            padding: 8px;
            border-radius: 10px;
        }
        .student-name {
            font-size: 26px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
        }

        /* --- √ÅREA DE DATOS INFERIOR (Grid) --- */
        .data-grid {
            display: grid;
            /* Dos columnas: una estrecha para el icono, otra para el dato */
            grid-template-columns: 40px 1fr; 
            gap: 8px; /* Espacio entre filas */
            align-items: center;
            background: rgba(0, 0, 0, 0.25); /* Fondo oscuro para el bloque de datos */
            padding: 15px;
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .data-icon {
            font-size: 32px;
            text-align: center;
            /* Un gradiente sutil en el icono */
            background: linear-gradient(180deg, #fff, #aaa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(1px 1px 2px rgba(0,0,0,0.5));
        }

        .data-row {
            display: flex;
            justify-content: space-between; /* Etiqueta a la izquierda, valor a la derecha */
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2); /* L√≠nea separadora sutil */
            padding-bottom: 4px;
        }
        /* Quitamos la l√≠nea de la √∫ltima fila */
        .data-grid .data-row:last-child {
            border-bottom: none;
        }

        .data-label {
            font-size: 18px;
            font-weight: 700;
            color: #ddd;
        }

        .data-value {
            font-size: 22px;
            font-weight: 900;
            text-align: right;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        /* Bot√≥n de descarga (fuera de la tarjeta) */
        .download-btn {
            margin-top: 20px;
            padding: 15px 40px;
            background: linear-gradient(45deg, #00c853, #64dd17); /* Verde vibrante */
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .download-btn:hover {
            transform: translateY(-3px); /* Efecto de elevaci√≥n al pasar el mouse */
            box-shadow: 0 15px 25px rgba(0,0,0,0.4);
        }
    </style>
</head>
<body>

    <div class="card" id="credencial-container">
        <div class="left-section">
            <img id="foto-alumno" class="student-photo" src="" alt="Foto del Alumno">
            
            <div class="triangle-overlay" id="triangle-bg">
                <span class="reg-text" id="reg-sigla">R.E.M.A.E.P</span>
            </div>
            
            <div class="qr-overlay">
                 <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=Validado" alt="QR Code">
            </div>
        </div>

        <div class="right-section" id="right-panel-bg">
            <div class="texture-overlay"></div>
            
            <div class="content-container">
                <div class="header-container">
                    <div class="main-header">Carnet</div>
                    <div class="year-header" id="anio-header">2026</div>
                </div>

                <div class="title-container">
                    <div class="main-title" id="titulo-principal">PARAM√âDICO</div>
                    <div class="sub-title" id="titulo-secundario">PROFESIONAL</div>
                </div>

                <div class="student-name-container">
                    <div class="student-name" id="nombre-alumno">Marcelo Alejandro Patri</div>
                </div>

                <div class="data-grid">
                    <div class="data-icon">‚ú±</div>
                    <div class="data-row">
                        <span class="data-label">CI/DNI:</span>
                        <span class="data-value" id="dni-valor">33656107</span>
                    </div>
                    
                    <div class="data-icon">#</div>
                    <div class="data-row">
                        <span class="data-label">MATR√çCULA:</span>
                        <span class="data-value" id="matricula-valor">6248-232637</span>
                    </div>
                    
                    <div class="data-icon">üö®</div>
                    <div class="data-row">
                        <span class="data-label">VENCE:</span>
                        <span class="data-value" id="vence-valor">11/01/2027</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <button class="download-btn" id="btnDescargar">
        ‚¨á Descargar Credencial
    </button>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- 1. SIMULACI√ìN DE DATOS ---
            // En el sistema real, esto vendr√° de la base de datos.
            const datosAlumno = {
                nombre: "Mar√≠a Eugenia Gonz√°lez",
                dni: "40.123.456",
                matricula: "R-98765/2024",
                vencimiento: "31/12/2030",
                anio: "2030",
                // Cambia el registro para ver c√≥mo cambian los colores:
                // 'remaep' (Azul), 'rniue' (Dorado), 'rubra' (Rojo), 'rmts' (Verde)
                registro: 'remaep', 
                titulo: "ESPECIALIZACI√ìN EN ENFERMER√çA DE URGENCIAS Y CAT√ÅSTROFES",
                fotoUrl: "https://randomuser.me/api/portraits/women/44.jpg" // Foto de ejemplo
            };

            // --- 2. FUNCI√ìN PARA AJUSTAR EL TAMA√ëO DE FUENTE DEL T√çTULO ---
            // Si el t√≠tulo es muy largo, reduce la letra para que entre bien.
            function ajustarFuenteTitulo(tituloMain, tituloSub, textoCompleto) {
                const longitud = textoCompleto.length;
                let mainSize, subSize;

                if (longitud < 20) {
                    mainSize = "46px"; subSize = "30px";
                } else if (longitud < 40) {
                    mainSize = "38px"; subSize = "26px";
                } else if (longitud < 60) {
                    mainSize = "30px"; subSize = "22px";
                } else {
                    // Para t√≠tulos extremadamente largos
                    mainSize = "24px"; subSize = "18px";
                }

                tituloMain.style.fontSize = mainSize;
                tituloSub.style.fontSize = subSize;
            }


            // --- 3. FUNCI√ìN PRINCIPAL PARA POBLAR LA TARJETA ---
            function cargarDatosEnCredencial(datos) {
                // A. Cargar Textos B√°sicos
                document.getElementById('nombre-alumno').textContent = datos.nombre;
                document.getElementById('dni-valor').textContent = datos.dni;
                document.getElementById('matricula-valor').textContent = datos.matricula;
                document.getElementById('vence-valor').textContent = datos.vencimiento;
                document.getElementById('anio-header').textContent = datos.anio;
                document.getElementById('foto-alumno').src = datos.fotoUrl;

                // B. Procesar el T√≠tulo (Dividirlo en Principal y Secundario)
                const palabrasTitulo = datos.titulo.split(' ');
                let textoPrincipal = '';
                let textoSecundario = '';

                if (palabrasTitulo.length > 3 && datos.titulo.length > 25) {
                    // Si es largo, ponemos las primeras 3 palabras arriba y el resto abajo
                    textoPrincipal = palabrasTitulo.slice(0, 3).join(' ');
                    textoSecundario = palabrasTitulo.slice(3).join(' ');
                } else {
                    // Si es corto, todo en la l√≠nea principal
                    textoPrincipal = datos.titulo;
                }

                const tituloMainElem = document.getElementById('titulo-principal');
                const tituloSubElem = document.getElementById('titulo-secundario');
                
                tituloMainElem.textContent = textoPrincipal;
                tituloSubElem.textContent = textoSecundario;

                // Ajustar el tama√±o de letra din√°micamente
                ajustarFuenteTitulo(tituloMainElem, tituloSubElem, datos.titulo);


                // C. Aplicar Temas de Color seg√∫n el Registro (Gradientes Met√°licos)
                const rightPanelBg = document.getElementById('right-panel-bg');
                const triangleBg = document.getElementById('triangle-bg');
                const regSigla = document.getElementById('reg-sigla');
                const cardContainer = document.getElementById('credencial-container');

                let gradienteBase = '';
                let siglaTexto = '';
                let colorBorde = '';

                switch(datos.registro) {
                    case 'remaep': // Azul Met√°lico Profundo
                        gradienteBase = 'linear-gradient(135deg, #002266, #0044cc, #002266)';
                        siglaTexto = 'R.E.M.A.E.P';
                        colorBorde = '#0033cc';
                        break;
                    case 'rniue': // Dorado Met√°lico
                        gradienteBase = 'linear-gradient(135deg, #8a6e2f, #c9a64e, #8a6e2f)';
                        siglaTexto = 'R.N.I.U.E';
                        colorBorde = '#c9a64e';
                        break;
                    case 'rubra': // Rojo Met√°lico Intenso
                        gradienteBase = 'linear-gradient(135deg, #800000, #cc0000, #800000)';
                        siglaTexto = 'R.U.B.R.A';
                        colorBorde = '#cc0000';
                        break;
                    case 'rmts': // Verde Met√°lico Oscuro
                        gradienteBase = 'linear-gradient(135deg, #004d26, #008040, #004d26)';
                        siglaTexto = 'R.M.T.S';
                        colorBorde = '#008040';
                        break;
                    default: // Por defecto azul
                        gradienteBase = 'linear-gradient(135deg, #002266, #0044cc, #002266)';
                        siglaTexto = 'REGISTRO';
                        colorBorde = '#0033cc';
                }

                // Aplicar los colores y textos
                rightPanelBg.style.background = gradienteBase;
                triangleBg.style.background = gradienteBase;
                regSigla.textContent = siglaTexto;
                // V6: Aplicar el color del borde principal seg√∫n el registro
                cardContainer.style.borderColor = colorBorde;
            }

            // --- 4. EJECUTAR LA CARGA DE DATOS ---
            cargarDatosEnCredencial(datosAlumno);


            // --- 5. FUNCIONALIDAD DE DESCARGA (html2canvas) ---
            document.getElementById('btnDescargar').addEventListener('click', () => {
                const credencialElement = document.getElementById('credencial-container');
                
                // Usamos html2canvas para capturar el elemento
                html2canvas(credencialElement, {
                    scale: 2, // Captura a doble resoluci√≥n para mejor calidad
                    backgroundColor: null, // Mantiene la transparencia de las esquinas redondeadas
                    useCORS: true // Permite cargar im√°genes de dominios externos (como la foto de ejemplo)
                }).then(canvas => {
                    // Crear un enlace de descarga temporal
                    const link = document.createElement('a');
                    link.download = `Credencial-${datosAlumno.dni}.png`;
                    link.href = canvas.toDataURL("image/png");
                    link.click();
                }).catch(err => {
                    console.error("Error al generar la imagen:", err);
                    alert("Hubo un error al generar la imagen de la credencial.");
                });
            });
        });
    </script>
</body>
</html>
